# Devise Cheatsheet

I'm going to start by Adding [Devise](https://github.com/heartcombo/devise) to a brand new Rails app. If you want to follow this readme and make your own copy of this repo, the commands below will help.

## Installation and Initial Configuration
```
rails new devise_cheatsheet -T -d postgresql
```

You'll want to add devise to your Gemfile:
```
bundle add devise
```

Next, you'll want to run the generator:
```
rails g devise:install
```

There are instructions that appear in the console, including details of next steps that you'll want to do to get the most out of Devise's functionality. These things are done before adding your User (or equivalent) model.

1. Set your default url options for action_mailer (per environment)
2. make sure your application has a root route
3. Add flash messages to your application layout
4. generate the devise views so you can customize the html (optional)

### Configuring Action Mailer's URL options
You can add this to `config/environemnts/development.rb`
```rb
config.action_mailer.default_url_options = { host: 'localhost', port: 3000 }
```
### Setting up the Root route
Next you can create a welcome controller with a home action to serve as the home page for non authenticated users:

```
rails g controller welcome home
```
Then add this to your `config/routes.rb` file:
```rb
root 'welcome#home'
```
and fill in the contents of `app/views/welcome/home.html.erb` with your home page content:
```html
<h1>Welcome Home!</h1>
```
### Adding flash Messages

Here, we'll open up `app/views/layouts/application.html.erb`
```html
<!DOCTYPE html>
<html>
  <head>
    <title>DeviseCheatsheet</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>
  </head>

  <body>
    <p class="notice"><%= notice %></p>
    <p class="alert"><%= alert %></p>
    <%= yield %>
  </body>
</html>

```
Now flash messages generated by devise should be displayed when they're generated.
### Generating the devise views so we can edit later
```
rails g devise:views
```